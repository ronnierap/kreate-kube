# this is a default file. It does not define any toplevel Objects

default:
  generic:
    container_name: app
    service_port: 8080
    container_port: 8080
    replicas: {{ val.replicas | default(1) }}
    image_repo: {{ val.image_repo }}
    image_name: {{ konfig.appname }}.app
    image_version: {{ val.image_version }}
    project: {{ val.project }}

    cpu_limit:   1
    cpu_request: 200m
    memory_limit:   512M
    memory_request: 512M

  AntiAffinity:
    selector_key: app

  CronJob:
    imagePullPolicy: Always
    concurrencyPolicy: Allow
    successfulJobsHistoryLimit: 3
    runAsUser: 1000
    runAsGroup: 1000

  Deployment:
    imagePullPolicy: Always
    containerPort: 8080
    protocol: TCP
    revisionHistoryLimit: 1
    restartPolicy: Always
    terminationGracePeriodSeconds: 30

  HorizontalPodAutoscaler:
    minReplicas: 1
    maxReplicas: 3
    cpu_averageUtilization: 70
    memory_averageUtilization: 70

  HttpProbes:
    probe_path: /actuator/info

    startup_initialDelaySeconds: 10
    startup_periodSeconds: 2
    startup_timeoutSeconds: 1
    startup_successThreshold: 1
    startup_failureThreshold: 30
    startup_scheme: HTTP
    startup_path: "" # use probe_path
    startup_port: 8080

    readiness_periodSeconds: 2
    readiness_timeoutSeconds: 1
    readiness_successThreshold: 1
    readiness_failureThreshold: 1
    readiness_scheme: HTTP
    readiness_path: "" # use probe_path
    readiness_port: 8080

    liveness_periodSeconds: 2
    liveness_timeoutSeconds: 1
    liveness_successThreshold: 1
    liveness_failureThreshold: 3
    liveness_scheme: HTTP
    liveness_path: "" # use probe_path
    liveness_port: 8080

  Ingress:
    service: {{ val.appname }}-service

  KubernetesAnnotations:
    component: webservice
    managed_by: kreate-kube/kustomize

  PodDisruptionBudget:
    minAvailable: 1

  StatefulSet:
    imagePullPolicy: Always
    containerPort: 8080
    protocol: TCP
    revisionHistoryLimit: 1
    restartPolicy: Always
    terminationGracePeriodSeconds: 30
